-- 初始化默认分类数据
INSERT INTO categories (name, description, color) VALUES
    ('产品咨询', '关于产品功能和特性的问题', '#1890ff'),
    ('技术支持', '技术问题和故障排除', '#f5222d'),
    ('价格费用', '价格、费用相关问题', '#52c41a'),
    ('使用教程', '操作指南和使用方法', '#faad14'),
    ('售后问题', '售后服务相关问题', '#722ed1')
ON CONFLICT (name) DO NOTHING;

-- 插入一些示例问答数据以便测试
INSERT INTO qa_pairs (question, answer, category_id, asker, advisor, confidence) VALUES
    (
        '这个产品支持多少用户同时在线？',
        '我们的产品支持最多1000个用户同时在线，基础版本支持100个用户，专业版支持1000个用户。如果需要更多用户，可以联系我们定制企业版方案。',
        (SELECT id FROM categories WHERE name = '产品咨询'),
        '客户张三',
        '客服小李',
        0.9
    ),
    (
        '忘记密码怎么办？',
        '您可以通过以下步骤重置密码：1. 点击登录页面的"忘记密码"链接；2. 输入您的注册邮箱；3. 查收重置密码的邮件；4. 点击邮件中的重置链接；5. 设置新密码。如果没有收到邮件，请检查垃圾邮件文件夹。',
        (SELECT id FROM categories WHERE name = '使用教程'),
        '用户王五',
        '技术支持',
        0.95
    ),
    (
        '专业版的价格是多少？',
        '专业版定价为每月299元，年付可享受8折优惠（年费2390元）。专业版包含所有基础功能，外加高级分析报表、API接口、优先技术支持等功能。',
        (SELECT id FROM categories WHERE name = '价格费用'),
        '潜在客户',
        '销售顾问',
        0.92
    ),
    (
        '如何导出数据？',
        '数据导出功能在"设置"菜单中：1. 进入"设置" → "数据管理"；2. 选择要导出的数据类型；3. 选择导出格式（Excel/CSV）；4. 点击"导出"按钮；5. 系统会发送下载链接到您的邮箱。注意：大量数据导出可能需要几分钟时间。',
        (SELECT id FROM categories WHERE name = '使用教程'),
        '企业用户',
        '客服小陈',
        0.88
    ),
    (
        '系统出现500错误怎么解决？',
        '500错误通常是服务器内部错误，请尝试以下解决方案：1. 刷新页面重试；2. 清除浏览器缓存和Cookie；3. 更换浏览器或无痕模式访问；4. 检查网络连接；5. 如果问题持续存在，请提供错误截图和操作步骤，联系技术支持。',
        (SELECT id FROM categories WHERE name = '技术支持'),
        '用户李四',
        '技术工程师',
        0.85
    ),
    (
        '退款政策是什么？',
        '我们提供30天无条件退款保证：1. 购买30天内可申请全额退款；2. 通过官网"联系客服"或邮件申请；3. 提供订单号和退款原因；4. 工作日3-5天内完成退款审核；5. 退款将原路返回到支付账户。注意：定制开发服务不支持退款。',
        (SELECT id FROM categories WHERE name = '售后问题'),
        '不满意用户',
        '客服主管',
        0.93
    ),
    (
        '如何设置API接口？',
        'API接口设置步骤：1. 登录管理后台；2. 进入"开发者设置"；3. 点击"创建API密钥"；4. 设置权限范围（读取/写入）；5. 复制生成的API Key；6. 参考API文档进行集成。API文档地址：https://docs.example.com/api',
        (SELECT id FROM categories WHERE name = '技术支持'),
        '开发者用户',
        '技术支持',
        0.91
    ),
    (
        '企业版有哪些额外功能？',
        '企业版相比专业版增加了以下功能：1. 无限用户数量；2. 高级数据分析和自定义报表；3. SSO单点登录支持；4. 专属客户经理；5. 7x24小时技术支持；6. 定制开发服务；7. 私有化部署选项；8. SLA服务保障。',
        (SELECT id FROM categories WHERE name = '产品咨询'),
        '大客户经理',
        '销售总监',
        0.96
    );

-- 更新分类的 qa_count（虽然有触发器，但为了确保数据一致性）
UPDATE categories SET qa_count = (
    SELECT COUNT(*) FROM qa_pairs WHERE qa_pairs.category_id = categories.id
);